<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>TERMINAL UPLOAD - RESTRICTED ACCESS</title>
  
  <!-- Matrix Rain Background -->
  <style>
    /* Canvas untuk partikel */
    #matrix-canvas {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      background-color: #000;
    }

    body, .container {
      position: relative;
      z-index: 1;
    }

    body {
      background-color: #000;
      color: #00ff00;
      font-family: monospace;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    .container {
      max-width: 700px;
      margin: 4em auto;
      background-color: #050505;
      padding: 2em;
      border: 1px solid #00ff00;
      border-radius: 10px;
      box-shadow: 0 0 15px #00ff00;
    }

    h2 {
      text-align: center;
      font-size: 1.5em;
      text-shadow: 0 0 6px #00ff00;
      margin-bottom: 1em;
      position: relative;
      display: inline-block;
      animation: glitch-text 1s infinite;
    }

    input[type="file"],
    input[type="submit"] {
      background-color: #000;
      color: #00ff00;
      border: 1px solid #00ff00;
      padding: 0.8em;
      width: 100%;
      margin-bottom: 1em;
      border-radius: 4px;
      font-family: monospace;
    }

    input[type="submit"]:hover {
      background-color: #00ff00;
      color: #000;
      cursor: pointer;
    }

    .progress-container {
      background: #111;
      border: 1px solid #00ff00;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 10px;
    }

    .progress-bar {
      height: 18px;
      background: #00ff00;
      width: 0%;
      transition: width 0.2s ease-in-out;
    }

    #status {
      margin-top: 0.5em;
      font-size: 0.9em;
      color: #0f0;
      text-shadow: 0 0 4px #00ff00;
      animation: glitch-text 2s infinite;
      display: inline-block;
    }

    ul {
      list-style: none;
      padding: 0;
      margin-top: 2em;
    }

    li {
      background-color: #111;
      border: 1px solid #00ff00;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      animation: glitch-text 3s infinite;
    }

    a.download-btn {
      color: #00ff00;
      text-decoration: none;
      background-color: #000;
      border: 1px solid #00ff00;
      padding: 6px 10px;
      border-radius: 4px;
      transition: background-color 0.3s, color 0.3s;
    }

    a.download-btn:hover {
      background-color: #00ff00;
      color: #000;
    }

    /* Glitch Effect */
    .glitch-footer {
      position: relative;
      display: inline-block;
      max-width: 700px;
      text-align: center;
      color: #00ff00;
      font-family: monospace;
      font-size: 0.85em;
      animation: glitch-text 4s infinite;
    }

    /* Keyframes glitch */
    @keyframes glitch-text {
      0% {
        text-shadow:
          2px 0 red,
          -2px 0 blue;
        transform: skew(-2deg);
      }
      20% {
        text-shadow:
          -2px 0 red,
          2px 0 blue;
        transform: scale(1.01);
      }
      40% {
        text-shadow:
          2px 0 lime,
          -2px 0 magenta;
        transform: scale(1.02);
      }
      60% {
        text-shadow:
          -2px 0 cyan,
          2px 0 yellow;
        transform: scale(0.98);
      }
      80%, 100% {
        text-shadow: none;
        transform: none;
      }
    }
  </style>
</head>
<body>
  <!-- Canvas partikel Matrix -->
  <canvas id="matrix-canvas"></canvas>

  <div class="container">
    <h2>üï∂Ô∏è FILE INJECTION TERMINAL</h2>

    <form id="upload-form">
      <input type="file" name="file" id="file" multiple required />
      <input type="submit" value="EXECUTE UPLOAD" />
    </form>

    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>
    </div>
    <p id="status"></p>

    <h3>üìÅ STORED FILES</h3>
    <ul id="file-list">
      {% for f in files %}
        <li>
          <span>{{ f }}</span>
          <a class="download-btn" href="/uploads/{{ f }}" download>DOWNLOAD</a>
        </li>
      {% endfor %}
    </ul>
  </div>

<footer style="margin-top: 4em; display: flex; justify-content: center; width: 100%;">
  <div class="glitch-footer">
    <hr style="border: none; border-top: 1px dashed #00ff00; margin: 2em 0;">
    <p>
      üìÇ Baca file 
      <a href="https://github.com/kortek-los/FileTransferLan/blob/main/README.md" target="_blank" style="color: #00ff00; text-decoration: underline;">
        Read.Me
      </a> sebelum lo ngapa-ngapain. Atau tanggung sendiri akibatnya.
    </p>
    <p>
      Coded in the shadows by 
      <a href="https://discord.com/users/nyawme" target="_blank" style="color: #00ff00; text-decoration: none;">
        ‚ò†Ô∏è Nyawme
      </a> &nbsp;|&nbsp;
      <a href="https://github.com/kortek-los" target="_blank" style="color: #00ff00; text-decoration: none;">
        üß¨ GitHub (akses dibatasi)
      </a>
    </p>
  </div>
</footer>

<script>
  // Efek glitch acak di footer (sudah ada tapi aku pertajam sedikit)
  function randomGlitch() {
    const footer = document.querySelector('.glitch-footer');
    footer.classList.add('glitch-active');
    setTimeout(() => {
      footer.classList.remove('glitch-active');
    }, 600);
    const next = Math.floor(Math.random() * 7000) + 5000;
    setTimeout(randomGlitch, next);
  }
  window.addEventListener('load', () => {
    setTimeout(randomGlitch, 3000);
  });

  // Upload logic (tetap sama)
  document.getElementById('upload-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const files = document.getElementById('file').files;
    const formData = new FormData();
    for (let i = 0; i < files.length; i++) {
      formData.append('file', files[i]);
    }

    const xhr = new XMLHttpRequest();
    xhr.open('POST', '/', true);

    xhr.upload.onprogress = function(e) {
      if (e.lengthComputable) {
        const percent = (e.loaded / e.total) * 100;
        document.getElementById('progress-bar').style.width = percent + '%';
      }
    };

    xhr.onload = function() {
      if (xhr.status === 200) {
        document.getElementById('status').innerText = '‚úîÔ∏è Upload complete. File injected.';
        document.getElementById('progress-bar').style.width = '0%';

        const newFiles = JSON.parse(xhr.responseText);
        const list = document.getElementById('file-list');
        newFiles.forEach(file => {
          const li = document.createElement('li');
          const span = document.createElement('span');
          span.textContent = file;
          const a = document.createElement('a');
          a.href = '/uploads/' + file;
          a.textContent = 'DOWNLOAD';
          a.className = 'download-btn';
          a.download = file;
          li.appendChild(span);
          li.appendChild(a);
          list.appendChild(li);
        });
      } else {
        document.getElementById('status').innerText = '‚ùå Upload failed. Target refused injection.';
      }
    };

    xhr.send(formData);
  });

  // === Matrix rain effect ===
  const canvas = document.getElementById('matrix-canvas');
  const ctx = canvas.getContext('2d');

  let width, height;
  let columns;
  let drops;

  function initMatrix() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;

    const fontSize = 16;
    columns = Math.floor(width / fontSize);
    drops = [];
    for(let i = 0; i < columns; i++) {
      drops[i] = Math.random() * -1000; // random start position y
    }

    ctx.font = fontSize + "px monospace";
  }

  function draw() {
    ctx.fillStyle = "rgba(0, 0, 0, 0.1)";
    ctx.fillRect(0, 0, width, height);

    ctx.fillStyle = "#0F0";
    const fontSize = 16;

    for(let i = 0; i < columns; i++) {
      const text = String.fromCharCode(0x30A0 + Math.random() * 96);
      ctx.fillText(text, i * fontSize, drops[i] * fontSize);

      if(drops[i] * fontSize > height && Math.random() > 0.975) {
        drops[i] = 0;
      }

      drops[i] += 1;
    }
  }

  window.addEventListener('resize', () => {
    initMatrix();
  });

  window.onload = () => {
    initMatrix();
    setInterval(draw, 33);
  };
</script>
</body>
</html>
